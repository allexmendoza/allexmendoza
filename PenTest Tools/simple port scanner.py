#!/usr/bin/env python3
import socket

# Get target from user
target = input("Enter IP or domain: ")

# Common ports to check
ports = [1, 7, 9, 13, 17, 19, 20, 21, 22, 23, 25, 37, 42, 43, 49, 53, 69, 70, 79, 80, 88, 102, 110, 111, 113, 119, 123, 135, 137, 138, 139, 143, 161, 162, 179, 194, 199, 389, 427, 443, 444, 445, 465, 500, 512, 513, 514, 515, 520, 524, 540, 548, 554, 587, 593, 631, 636, 691, 749, 993, 995, 1080, 1100, 1241, 1433, 1434, 1521, 1723, 1755, 1900, 2000, 2001, 2049, 2121, 2717, 3000, 3128, 3306, 3389, 3690, 4333, 4444, 4500, 4899, 5000, 5004, 5009, 5030, 5060, 5061, 5190, 5357, 5432, 5631, 5666, 5800, 5900, 5901, 5986, 6000, 6001, 6646, 7000, 7070, 7937, 7938, 8000, 8002, 8008, 8009, 8020, 8080, 8081, 8082, 8083, 8086, 8087, 8088, 8090, 8180, 8443, 8500, 8834, 8880, 8888, 8899, 9000, 9001, 9030, 9040, 9050, 9071, 9080, 9090, 9091, 9200, 9443, 9999, 10000, 10009, 10050, 10051, 11211, 27017, 27018, 27019, 50000]

# Port service names
services = {
    1: "TCPMUX", 7: "Echo", 9: "Discard", 13: "Daytime", 17: "QOTD", 19: "Chargen",
    20: "FTP-Data", 21: "FTP", 22: "SSH", 23: "Telnet", 25: "SMTP", 37: "Time",
    42: "WINS", 43: "WHOIS", 49: "TACACS", 53: "DNS", 69: "TFTP", 70: "Gopher",
    79: "Finger", 80: "HTTP", 88: "Kerberos", 102: "MS-RPC", 110: "POP3", 111: "RPC",
    113: "Ident", 119: "NNTP", 123: "NTP", 135: "MS-RPC", 137: "NetBIOS-NS",
    138: "NetBIOS-DGM", 139: "NetBIOS-SSN", 143: "IMAP", 161: "SNMP", 162: "SNMP-Trap",
    179: "BGP", 194: "IRC", 199: "SMUX", 389: "LDAP", 427: "SLP", 443: "HTTPS",
    444: "SNPP", 445: "SMB", 465: "SMTPS", 500: "IPSec", 512: "rlogin", 513: "rsh",
    514: "Syslog", 515: "LPR", 520: "RIP", 524: "NCP", 540: "UUCP", 548: "AFP",
    554: "RTSP", 587: "SMTP-Auth", 593: "MS-RPC-HTTPS", 631: "IPP", 636: "LDAPS",
    691: "MS-Exchange", 749: "Kerberos-Admin", 993: "IMAPS", 995: "POP3S", 1080: "SOCKS",
    1100: "JavaRMI", 1241: "Nessus", 1433: "MSSQL", 1434: "MSSQL-Mon", 1521: "Oracle",
    1723: "PPTP", 1755: "MMS", 1900: "UPnP", 2000: "Cisco-SCCP", 2001: "Cisco-DC",
    2049: "NFS", 2121: "FTP-Proxy", 2717: "PN-Requester", 3000: "NodeJS", 3128: "Squid",
    3306: "MySQL", 3389: "RDP", 3690: "SVN", 4333: "mSQL", 4444: "Metasploit",
    4500: "IPSec-NAT", 4899: "Radmin", 5000: "UPnP", 5004: "RTP", 5009: "Airport-Admin",
    5030: "Surfpass", 5060: "SIP", 5061: "SIP-TLS", 5190: "AIM", 5357: "WSDAPI",
    5432: "PostgreSQL", 5631: "PCAnywhere", 5666: "Nagios-NRPE", 5800: "VNC-HTTP",
    5900: "VNC", 5901: "VNC-1", 5986: "WinRM-HTTP", 6000: "X11", 6001: "X11-1",
    6646: "McAfee-NAI", 7000: "AFS", 7070: "RealServer", 7937: "NSRexecd", 7938: "LGTOMAPPER",
    8000: "HTTP-Alt", 8002: "HTTP-Alt", 8008: "HTTP-Alt", 8009: "Ajp13", 8020: "HTTP-Alt",
    8080: "HTTP-Proxy", 8081: "HTTP-Alt", 8082: "HTTP-Alt", 8083: "HTTP-Alt", 8086: "Kaspersky",
    8087: "Kaspersky", 8088: "Radan-HTTP", 8090: "HTTP-Alt", 8180: "HTTP-Alt", 8443: "HTTPS-Alt",
    8500: "fmtp", 8834: "Nessus-HTTP", 8880: "Cddb", 8888: "HTTP-Alt", 8899: "jabber",
    9000: "CSlistener", 9001: "ETL-Servicemgr", 9030: "Tor-Auth", 9040: "Tor-Trans",
    9050: "Tor-SOCKS", 9071: "Tor-Control", 9080: "Glrpc", 9090: "Zeus-Admin",
    9091: "xmltec-xmlmail", 9200: "Elasticsearch", 9443: "WSO2", 9999: "Abyss",
    10000: "Webmin", 10009: "Swat", 10050: "Zabbix-Agent", 10051: "Zabbix-Trapper",
    11211: "Memcached", 27017: "MongoDB", 27018: "MongoDB-Shard", 27019: "MongoDB-Config",
    50000: "SAP"
}

print(f"Scanning {target}")
print("-" * 20)

open_ports = 0
for port in ports:
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    sock.settimeout(1)
    
    try:
        result = sock.connect_ex((target, port))
        if result == 0:
            service_name = services.get(port, "Unknown")
            print(f"Port {port} ({service_name}) is OPEN")
            open_ports += 1
        sock.close()
    except:
        pass

print(f"\nFound {open_ports} open ports")